<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
	<head>
		<title>Hello World</title>
		<script type="text/javascript" src="node_modules/jquery/dist/jquery.min.js"></script>
		<script type="text/javascript" src="node_modules/vss-web-extension-sdk/lib/VSS.SDK.min.js"></script>
		<script type="text/javascript" src="node_modules/jszip/dist/jszip.min.js"></script>
		<script type="text/javascript" src="node_modules/devextreme/dist/js/dx.web.js"></script>
		<link rel="stylesheet" type="text/css" href="node_modules/devextreme/dist/css/dx.common.css" />
		<link rel="stylesheet" type="text/css" href="node_modules/devextreme/dist/css/dx.light.css" />
	</head>
	<style>
	
		.content {
			display: flex;
			flex-direction: row;
			align-items: center;
			justify-content: center;
		}

		.formContent {
			display: flex;
			flex-direction: column;
			width: 270px;
			height: 220px;
			justify-content: space-between;
		}

		.rowWrap {
			display: flex;
			flex-direction: row;
			justify-content: space-between;
			align-items: center;
		}

		.rowLabel {
			display: flex;
			flex-direction: row;
			justify-content: flex-end;
			width: 100px;
		}

		.rowControl {
			display: flex;
			flex-direction: row;
			justify-content: flex-end;
		}

	</style>
	<body>
		<script>

		// Initialize
		VSS.init({
			usePlatformScripts: true, 
			usePlatformStyles: true
		});

		// Register callback to get called when initial handshake completed
		VSS.ready(function() {
			var webContext = VSS.getWebContext();
			var extensionContext = VSS.getExtensionContext();

			var taskTypes = [
				"Analysis",
				"Coding",
				"Communications",
				"Demo",
				"Design",
				"Documentation",
				"Other",
				"Project Management",
				"Software Installs",
				"Technical Support",
				"Testing",
				"Training"
			];
			
			$("#recordTaskType").dxSelectBox({
				items: taskTypes,
				value: taskTypes[1],
				width: 150
			});
			
			var now = new Date();

			$("#recordDate").dxDateBox({
				type: "date",
				value: now,
				width: 150
			});

			$("#recordActualWork").dxTextBox({
				mask: "00:00",
				maskChar: "0",
				width: 150
			});

			$("#recordEstimateWork").dxTextBox({
				mask: "00:00",
				maskChar: "0",
				width: 150
			});

			$("#recordSubmit").dxButton({
				text: "Submit",
				type: "success",
				onClick: function(e) {
					DevExpress.ui.notify("The Submit button was clicked");
				}
			});
			
			VSS.getAccessToken().then(function(token){
				debugger;
			});
			
			VSS.getAppToken().then(function(token){
				debugger;
			});
			
			debugger;
			VSS.notifyLoadSucceeded();
		});

		</script>

		<div class="content">
		  <div class="formContent">

			<div class="rowWrap">
			  <label for="recordTaskType" class="rowLabel">Task Type</label>
			  <div id="recordTaskType" class="rowControl"></div>
			</div>
		  
			<div class="rowWrap">
			  <label for="recordDate" class="rowLabel">Record Date</label>
			  <div id="recordDate" class="rowControl"></div>
			</div>

			<div class="rowWrap">
			  <label for="recordActualWork" class="rowLabel">Actual Work</label>
			  <div id="recordActualWork" class="rowControl"></div>
			</div>

			<div class="rowWrap">
			  <label for="recordEstimateWork" class="rowLabel">Estimate Work</label>
			  <div id="recordEstimateWork" class="rowControl"></div>
			</div>

			<div id="recordSubmit"></div>

		  </div>
		</div>
		
	</body>
</html>